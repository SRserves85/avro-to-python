{%- block map %}
    def set_{{name}}(self, values: list) -> None:
        self.{{name}} = []
        if isinstance(values, list):
            for item in values:
                for key, value in item.items():

                    if not isinstance(key, str):
                        raise TypeError(
                            "Keys in map types must be strings!"
                        )

                    {#- handle tons of types without recursion which sucks... -#}
                    {%- if field.map_type.fieldtype == 'reference' %}
                    self.{{name}}.append({key: {{file.resolve_reference_name(field.map_type, pip_import)}}(value)})
                    {%- elif field.map_type.fieldtype == 'primitive'%}
                    if isinstance(value, {{is_instance_primitive_type_map[field.map_type.avrotype]}}):
                        self.{{name}}.append({key: value})
                    else:
                        raise TypeError(
                            f"Type for '{{name}}' should be '{{is_instance_primitive_type_map[field.map_type.avrotype]}}' but was: {value}"
                        )
                    {%- elif field.map_type.fieldtype == 'map'%}
                    sub_array = []
                    if isinstance(value, list):
                        for sub_item in value:
                            for sub_key, sub_value in sub_item.items():
                                if not isinstance(sub_key, str):
                                    raise TypeError(
                                        "keys in map types must be strings"
                                    )
                                {%- if field.map_type.map_type.fieldtype == 'reference' %}
                                sub_array.append({sub_key: {{file.resolve_reference_name(field.map_type.map_type, pip_import)}}(sub_value)})
                                {%- elif field.map_type.map_type.fieldtype == 'primitive'%}
                                if isinstance(sub_value, {{is_instance_primitive_type_map[field.map_type.map_type.avrotype]}}):
                                    sub_array.append({sub_key: sub_value})
                                else:
                                    raise TypeError(
                                        f"Type for '{{name}}' should be '{{is_instance_primitive_type_map[field.map_type.map_type.avrotype]}}' but was: {sub_value}"
                                    )
                                {%- endif %}
                    self.{{name}}.append({key: sub_array})
                    {%- elif field.map_type.fieldtype == 'array'%}
                    sub_array = []
                    if isinstance(value, list):
                        for element in value:
                            {#- handle tons of types which sucks... -#}
                            {%- if field.map_type.array_item_type.fieldtype == 'reference' %}
                            sub_array.append({{file.resolve_reference_name(field.map_type.array_item_type, pip_import)}}(element))
                            {%- elif field.array_item_type.fieldtype == 'primitive'%}
                            if isinstance(element, {{is_instance_primitive_type_map[field.map_type.array_item_type.avrotype]}}):
                                sub_array.append(element)
                            else:
                                raise TypeError(
                                    f"Type for '{{name}}' should be '{{is_instance_primitive_type_map[field.array_item_type.avrotype]}}' but was: {element}"
                                )
                            {%- endif %}
                    {%- endif %}
        else:
            raise TypeError(f"Field '{{name}}' should be type list but was: {values}")

    def get_{{name}}(self) -> list:
        return self.{{name}}
{%- endblock -%}
